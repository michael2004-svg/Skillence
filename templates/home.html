<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Skillence App</title>
    <link rel="stylesheet" href="../styles/style.css">
    <link rel="stylesheet" href="../styles/profile.css">
    <link rel="stylesheet" href="../styles/cv.css">
    <link rel="stylesheet" href="../styles/notification.css">
    <link rel="stylesheet" href="../styles/courses.css">
    <script src="https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.min.js"></script>
    <script src="https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.worker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="header">
        <div class="logo">
            <div class="logo-icon">S</div>
            <div class="logo-text">Skillence</div>
        </div>
        <div class="search-bar">
            <div class="search-icon">üîç</div>
            <input type="text" class="search-input" placeholder="What's on your mind?" id="searchInput">
        </div>
    </div>

   <!-- Home Tab Content -->
<div class="tab-content active" id="home-tab">
    <div class="home-content" id="feedContainer">
        <div class="loading-container" id="loadingContainer">
            <div class="spinner"></div>
            <div class="loading-text">Loading...</div>
        </div>
    </div>
</div>
</div>
        </div>
    </div>

    <!-- Profile Tab Content -->
<div class="tab-content hidden" id="profile-tab">
    <div class="profile-content-new">
        <!-- Cover Image -->
        <div class="profile-cover">
            <div class="profile-cover-gradient"></div>
        </div>
        
        <!-- Profile Header -->
       <div class="profile-header-new">
    <div class="profile-avatar-container">
        <img src="../images/default.jpg" id="profileAvatar" class="profile-avatar-large">
    </div>
    
    <div class="profile-info-section">
        <div class="profile-name-section">
            <h2 class="profile-name-large" id="profile-job">Loading...</h2>
            <p class="profile-handle" id="profile-industry">Loading...</p>
        </div>
        
        <!-- PROFILE ACTIONS - WITH EDIT BUTTON -->
        <div class="profile-actions">
            <button id="editProfileBtn" class="edit-profile-btn">
                ‚úèÔ∏è Edit Profile
            </button>
            <button class="follow-btn" onclick="toggleFollow()">
                Follow
            </button>
            <button id="sign-out-btn" class="sign-out-btn">
                Sign Out
            </button>
        </div>
    </div>
       </div>
        
        <!-- Profile Stats -->
        <div class="profile-stats-bar">
            <div class="stat-item">
                <div class="stat-number" id="followers-count">0</div>
                <div class="stat-label">Followers</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <div class="stat-number" id="following-count">0</div>
                <div class="stat-label">Following</div>
            </div>
            <div class="stat-divider"></div>
            <div class="stat-item">
                <div class="stat-number" id="cv-score">0%</div>
                <div class="stat-label">Skill Score</div>
            </div>
        </div>
        
        <!-- Profile Details -->
        <div class="profile-details-section">
            <div class="profile-detail-card">
                <div class="detail-icon">üíº</div>
                <div class="detail-content">
                    <div class="detail-label">Experience</div>
                    <div class="detail-value" id="profile-experience">Loading...</div>
                </div>
            </div>
            
            <div class="profile-detail-card">
                <div class="detail-icon">üéØ</div>
                <div class="detail-content">
                    <div class="detail-label">Skills</div>
                    <div class="detail-value" id="profile-skills">Loading...</div>
                </div>
            </div>
            
            <div class="profile-detail-card">
                <div class="detail-icon">üöÄ</div>
                <div class="detail-content">
                    <div class="detail-label">Goals</div>
                    <div class="detail-value" id="profile-goals">Loading...</div>
                </div>
            </div>
        </div>
        
        <!-- Skill Score Progress -->
        <div class="skill-score-widget">
            <div class="skill-score-header">
                <h3 class="skill-score-title">Professional Skill Score</h3>
                <div class="skill-score-badge" id="cv-score-display">0%</div>
            </div>
            <div class="progress-bar-new">
                <div class="progress-fill-new" id="cv-score-progress" style="width: 0%;"></div>
            </div>
        </div>
        
        <!-- Profile Tabs -->
        <div class="profile-tabs-section">
            <div class="profile-tabs">
                <button class="profile-tab-btn active" onclick="switchProfileTab('posts')">
                    <span class="tab-icon">üìù</span>
                    Posts
                </button>
                <button class="profile-tab-btn" onclick="switchProfileTab('about')">
                    <span class="tab-icon">‚ÑπÔ∏è</span>
                    About
                </button>
            </div>
        </div>
        
        <!-- Posts Tab -->
        <div class="profile-tab-content active" id="profile-posts-tab">
            <div id="profile-posts-container" class="profile-posts-grid">
                <div class="loading-container">
                    <div class="spinner"></div>
                    <div class="loading-text">Loading posts...</div>
                </div>
            </div>
        </div>
        
        <!-- About Tab -->
        <div class="profile-tab-content" id="profile-about-tab">
            <div class="about-section">
                <div class="about-card">
                    <h4 class="about-card-title">Latest CV Analysis</h4>
                    <div class="about-card-content">
                        <p><strong>Industry:</strong> <span id="cv-industry">Not analyzed</span></p>
                        <p><strong>Top Skills:</strong> <span id="cv-skills">None listed</span></p>
                        <p><strong>Last Updated:</strong> <span id="cv-timestamp">No analysis available</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Notifications Tab Content -->
<div class="tab-content hidden" id="notifications-tab">
    <div class="notifications-content">
        <div class="notifications-header">
            <h2 class="notifications-title">Notifications</h2>
            <button class="mark-all-read-btn" onclick="window.NotificationsModule.markAllAsRead()">
                Mark all as read
            </button>
        </div>
        
        <div class="notification-filters">
            <button class="notification-filter-btn active" data-filter="all" onclick="window.NotificationsModule.filterNotifications('all')">
                All
            </button>
            <button class="notification-filter-btn" data-filter="like" onclick="window.NotificationsModule.filterNotifications('like')">
                ‚ù§Ô∏è Likes
            </button>
            <button class="notification-filter-btn" data-filter="comment" onclick="window.NotificationsModule.filterNotifications('comment')">
                üí¨ Comments
            </button>
            <button class="notification-filter-btn" data-filter="follow" onclick="window.NotificationsModule.filterNotifications('follow')">
                üë§ Follows
            </button>
        </div>
        
        <div id="notificationsContainer">
            <div class="loading-container">
                <div class="spinner"></div>
                <div class="loading-text">Loading notifications...</div>
            </div>
        </div>
    </div>
</div>

    <!-- Add Post Tab Content -->
    <div class="tab-content hidden" id="add-post-tab">
        <div class="add-post-content">
            <div class="create-post-container">
                <h2 class="create-post-title">Create New Post</h2>
                <div class="post-form">
                    <div class="user-info">
                        <div class="user-avatar">
                            <img src="../images/default.jpg" id="createPostAvatar">
                        </div>
                        <div class="user-details">
                            <div class="user-name" id="createPostName">Loading...</div>
                            <div class="post-visibility">
                                <select class="visibility-select">
                                    <option value="public">üåç Public</option>
                                    <option value="connections">üë• Connections only</option>
                                    <option value="private">üîí Only me</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="post-input-container">
                        <textarea class="post-textarea" placeholder="What would you like to share with your network?" maxlength="280" oninput="updateCharCount(this)"></textarea>
                        <div class="char-count">
                            <span id="char-counter">0</span>/280
                        </div>
                    </div>
                    <div class="post-options">
                        <div class="media-options">
                            <input type="file" id="postImage" accept="image/*" style="display: none;" onchange="previewPostImage(this)">
                            <button class="media-btn" onclick="document.getElementById('postImage').click()" title="Add Image">üì∑</button>
                            <button class="media-btn" onclick="handleMediaUpload('video')" title="Add Video">üé•</button>
                            <button class="media-btn" onclick="handleMediaUpload('document')" title="Add Document">üìé</button>
                            <button class="media-btn" onclick="addPoll()" title="Create Poll">üìä</button>
                            <button class="media-btn" onclick="addCelebration()" title="Celebrate">üéâ</button>
                        </div>
                        <div class="image-preview" id="imagePreview" style="display: none;">
                            <img id="previewImage" src="" alt="Image Preview" style="max-width: 100%; max-height: 200px;">
                            <button class="remove-image" onclick="removePostImage()">Remove</button>
                        </div>
                    </div>
                    <div class="post-actions">
                        <button class="cancel-btn" onclick="cancelPost()">Cancel</button>
                        <button class="post-btn" onclick="publishPost()" disabled>Post</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Career Tab Content -->
    <div class="tab-content hidden" id="career-tab">
        <div class="career-content">
            <div class="features-grid">
                <div class="feature-card" onclick="handleFeatureClick('cv-analyzer')">
                    <div class="feature-icon">üìã</div>
                    <div class="feature-title">CV Analyzer</div>
                </div>
                <div class="feature-card" onclick="handleFeatureClick('jobs')">
                    <div class="feature-icon">üíº</div>
                    <div class="feature-title">Jobs</div>
                </div>
                <div class="feature-card" onclick="handleFeatureClick('courses')">
                    <div class="feature-icon">üéì</div>
                    <div class="feature-title">Courses</div>
                </div>
                <div class="feature-card" onclick="handleFeatureClick('mentorship')">
                    <div class="feature-icon">ü§ù</div>
                    <div class="feature-title">Mentorship</div>
                </div>
            </div>
                        <!-- Courses Section -->
  <div class="courses-section hidden" id="coursesSection">
    <div class="courses-header">
        <button class="section-back-btn" onclick="goBackToCareer()">‚Üê Back to Career</button>
        <h2 class="courses-title">Courses</h2>
        <div class="courses-tabs">
            <button class="courses-tab-btn active" onclick="switchCoursesTab('browse')">Browse Courses</button>
            <button class="courses-tab-btn" onclick="switchCoursesTab('enrolled')">My Courses</button>
        </div>
        <div class="courses-search">
            <input type="text" id="coursesSearchInput" placeholder="Search courses..." class="search-input" oninput="searchCourses(this.value)">
        </div>
    </div>
    
    <!-- Browse Courses Tab -->
    <div class="courses-tab-content active" id="browseCoursesTab">
        <div class="courses-grid" id="coursesGrid">
            <p>Loading courses...</p>
        </div>
    </div>
    
    <!-- Enrolled Courses Tab -->
    <div class="courses-tab-content" id="enrolledCoursesTab">
        <div class="courses-grid" id="enrolledCoursesGrid">
            <p>No courses enrolled yet</p>
        </div>
    </div>
</div>

<!-- Mentorship Section -->
<div class="mentorship-section hidden" id="mentorshipSection">
    <div class="mentorship-header">
        <button class="section-back-btn" onclick="goBackToCareer()">‚Üê Back to Career</button>
        <h2 class="mentorship-title">Find Your Mentor</h2>
        <div class="mentorship-search">
            <input type="text" id="mentorshipSearchInput" placeholder="Search by expertise..." class="search-input" oninput="searchMentors(this.value)">
        </div>
    </div>
    <div class="mentors-grid" id="mentorsGrid">
        <p>Loading mentors...</p>
    </div>
</div>
            <div class="jobs-section hidden" id="jobsSection">
                <div class="jobs-header">
                    <button class="section-back-btn" onclick="goBackToCareer()">‚Üê Back to Career</button>
                    <h2 class="jobs-title">Job Opportunities</h2>
                    <div class="jobs-search">
                        <input type="text" id="jobsSearchWhat" placeholder="Job title or keywords (e.g., Software Engineer)" class="search-input">
                        <input type="text" id="jobsSearchWhere" placeholder="Location (e.g., London)" class="search-input">
                        <button class="search-btn" onclick="searchJobs()">Search Jobs</button>
                    </div>
                </div>
                <div class="jobs-list" id="jobsList">
                    <p>Loading jobs...</p>
                </div>
            </div>
        </div>
    </div>


    <!-- CV Analyzer Tab Content -->
    <div class="tab-content hidden" id="cv-analyzer-tab">
        <div class="cv-analyzer-content">
            <div class="cv-analyzer-header">
                <button class="section-back-btn" onclick="goBackToCareer()">‚Üê Back to Career</button>
                <h2 class="cv-analyzer-title">CV Analyzer</h2>
                <p class="cv-analyzer-subtitle">Upload your CV and get instant AI-powered analysis and recommendations</p>
            </div>
            <div class="job-description-container">
                <textarea id="jobDescription" class="job-description-input" placeholder="Paste job description here (optional)"></textarea>
            </div>
            <div class="upload-container" id="uploadContainer">
                <div class="upload-icon">üìÑ</div>
                <div class="upload-text">Drag & Drop Your CV Here</div>
                <div class="upload-hint">Or click to browse files ‚Ä¢ Supports PDF, DOC, DOCX ‚Ä¢ Max 10MB</div>
                <input type="file" id="cvUpload" class="file-input" accept=".pdf,.doc,.docx" />
                <button class="upload-btn" onclick="document.getElementById('cvUpload').click()">
                    Choose File
                </button>
                <button class="analyze-btn" id="analyzeBtn" onclick="uploadCV()">
                    <span id="btnText">Analyze CV</span>
                    <div class="loading-spinner" id="loadingSpinner" style="display: none;">
                        <div class="spinner"></div>
                        Analyzing...
                    </div>
                </button>
            </div>
            <div class="file-info" id="fileInfo">
                <div class="file-name" id="fileName"></div>
                <div class="file-details">
                    <span id="fileSize"></span>
                    <span id="fileType"></span>
                </div>
            </div>
            <div class="status-message" id="status-message"></div>
            <div class="result-container" id="result"></div>
            <div class="template-container hidden"></div>
        </div>
    </div>
     
    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <div class="nav-item active" onclick="switchTab('home')" data-tab="home">
            <div class="nav-icon">üè†</div>
        </div>
        <div class="nav-item" onclick="switchTab('career')" data-tab="career">
            <div class="nav-icon">üíº</div>
        </div>
        <button class="add-button" onclick="switchTab('add-post')">
            <span>+</span>
        </button>
        <div class="nav-item" onclick="switchTab('notifications')" data-tab="notifications">
            <div class="nav-icon">üîî</div>
        </div>
        <div class="nav-item" onclick="switchTab('profile')" data-tab="profile">
            <div class="nav-icon">üë§</div>
        </div>
    </div>

    <script src="../scripts/core.js"></script>
    <script src="../scripts/cv_analyzer.js"></script>
    <script src="../scripts/jobs.js"></script>
    <script src="../scripts/feed.js"></script>
    <script src="../scripts/refresh.js"></script>
    <script src="../scripts/savepost.js"></script>
    <script src="../scripts/posts.js"></script>
    <script src="../scripts/notification.js"></script>
    <script src="../scripts/courses.js"></script>
    <script src="../scripts/mentors.js"></script>
</body>
</html>